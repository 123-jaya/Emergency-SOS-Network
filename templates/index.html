<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOS Emergency Map</title>
</head>
<body>
    <h1>SOS Emergency Trigger</h1>

    <!-- Emergency Form -->
    <form method="POST">
        <label for="emergency_type">Emergency Type:</label>
        <select name="emergency_type" required>
            <option value="Fire">Fire</option>
            <option value="Accident">Accident</option>
            <option value="Medical">Medical</option>
            <option value="Flood">Flood</option>
        </select><br><br>
        
        <label for="location">Location:</label>
        <input type="text" name="location" required><br><br>
        
        <button type="submit">Trigger Emergency</button>
    </form>

    <!-- Message after form submission -->
    {% if message %}
    <p>{{ message }}</p>
    {% endif %}

    <!-- Pie chart of emergencies -->
    {% if chart %}
    <h3>Emergency Type Distribution</h3>
    <img src="data:image/png;base64,{{ chart }}" alt="Emergency Distribution Chart">
    {% endif %}

    <!-- Display the map directly -->
    <h3>Emergency Map</h3>
    <iframe src="/static/map.html" width="100%" height="600px"></iframe>

    <!-- List of all emergencies -->
    <h3>Emergency List</h3>
    <ul>
        {% for emergency in emergencies %}
        <li>{{ emergency['type'] }} at {{ emergency['location'] }} ({{ emergency['lat'] }}, {{ emergency['lon'] }})</li>
        {% endfor %}
    </ul>

    <!-- Clear all emergencies -->
    <form action="/clear" method="POST">
        <button type="submit">Clear All Emergencies</button>
    </form>
</body>
</html>
